<Window x:Class="Ticketing_Harry_Poter.Views.UserDashboard"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Mes Tickets"
        Width="1920" Height="1080"
        WindowStartupLocation="CenterScreen"
        WindowState="Normal">
    <DockPanel>
        <!-- Barre d'outils -->
        <ToolBar DockPanel.Dock="Top">
            <TextBlock Text="Bienvenue,"/>
            <TextBlock x:Name="UserNameText" FontWeight="Bold" Margin="5,0,20,0"/>
            <Button Content="Actualiser" Click="Refresh_Click"/>
            <Separator/>
            <Button Content="Nouveau ticket" Click="NewTicket_Click"/>
        </ToolBar>

        <!-- Grille + commentaires -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- DataGrid tickets -->
            <DataGrid x:Name="MyTicketsGrid"
                Grid.Row="0"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                SelectionChanged="MyTicketsGrid_SelectionChanged"
                Margin="10">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID"      Binding="{Binding Id}"      Width="50"/>
                    <DataGridTextColumn Header="Titre"   Binding="{Binding Title}"   Width="*"/>
                    <DataGridTextColumn Header="Catégorie" Binding="{Binding Category}" Width="150"/>
                    <DataGridTextColumn Header="Priorité"  Binding="{Binding Priority}" Width="150"/>
                    <DataGridTextColumn Header="Statut"    Binding="{Binding Status}"   Width="100"/>
                    <DataGridTextColumn Header="Créé le"   Binding="{Binding CreatedAt}" Width="200"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Section commentaires -->
            <Separator Grid.Row="1" Margin="10"/>
            <TextBlock Grid.Row="2" Text="Commentaires" FontSize="16" FontWeight="Bold" Margin="10,0,0,5"/>
            <ListBox x:Name="CommentsListUser"
               Grid.Row="2"
               Margin="10,25,10,10"
               Height="200">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="0,5">
                            <TextBlock Text="{Binding Author}" FontWeight="Bold"/>
                            <TextBlock Text="{Binding CreatedAt, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"
                         FontStyle="Italic" FontSize="10"/>
                            <TextBlock Text="{Binding Content}" TextWrapping="Wrap" Margin="0,2,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <TextBox x:Name="NewCommentBoxUser"
               Grid.Row="3"
               Height="60"
               Margin="10"
               TextWrapping="Wrap"
               AcceptsReturn="True"
               VerticalScrollBarVisibility="Auto"/>
            <Button Content="Ajouter commentaire"
              Grid.Row="3"
              Width="160"
              HorizontalAlignment="Right"
              Margin="0,0,10,10"
              Click="AddComment_Click"/>
        </Grid>
    </DockPanel>
</Window>
